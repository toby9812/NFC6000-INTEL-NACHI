REM "出料-開蓋-AOI(循環測試用)"
REM "VER.20240320"
USE 10
LETVI V19%,18	'目前執行子程序號碼
LETVI V20%,11	'目前執行交握動作號碼
LETVI V34%,18	'最後進行程序號碼
SETM O169,0
SETMD O171,1,0,3
SETM O170,0
' SETM O188,1 '行徑過程經過去水站 
' SETM O189,1 '行徑過程經過水洗站 
IF O193=1
LETVI V18%,11
ELSEIF O194=1
LETVI V18%,61
ELSEIF O195=1
LETVI V18%,31
ELSEIF O196=1
LETVI V18%,31
ELSEIF O197=1
LETVI V18%,51
ELSEIF O198=1
LETVI V18%,101
ELSEIF O199=1
LETVI V18%,81
ELSEIF O200=1
LETVI V18%,121
ENDIF
IF I169=1
IF V18%=126
GOTO *126
ELSEIF V18%=125
GOTO *125
ELSEIF V18%=124
GOTO *124
ELSEIF V18%=121
GOTO *121
ELSEIF V18%=11
GOTO *11
ELSEIF V18%=17
GOTO *17
ELSEIF V18%=18
GOTO *18
ELSEIF V18%=19
GOTO *19
ELSEIF V18%=177
GOTO *177
ELSEIF V18%=51
GOTO *51
ELSEIF V18%=52
GOTO *52
ELSEIF V18%=53
GOTO *53
ELSEIF V18%=54
GOTO *54
ELSEIF V18%=55
GOTO *55
ENDIF
ELSEIF I169=0
GOTO *START
ENDIF
*START
MOVEX A=1, AC=1, SM=1, M1X, P, P121, S=4500, H=1, MS	'121
INH
LETVI V18%,121
MOVEX A=5, AC=1, SM=1, M1X, L, P124, R=V30%, H=1, MS	'124
INH
LETVI V18%,124
MOVEX A=5, AC=1, SM=1, M1X, L, P125, R=V30%, H=1, MS	'125
INH
LETVI V18%,125
MOVEX A=5, AC=1, SM=1, M1X, L, P126, R=V30%, H=1, MS	'126
INH
LETVI V18%,126
MOVEX A=5, AC=1, SM=1, M1X, L, P127, R=V30%, H=1, MS	'127
INH
LETVI V18%,127
SETMD O207,1,0,5
LETVI V20%,84	'到出料取FOUP位
IF I171=1	'回原點訊號ON時
DELAY 1
GOTO *B
ELSE
GOTO *A
ENDIF
*A
IF V2%=13
LETVI V35%,13	'紀錄PLC交握數值
GOTO *B
ELSE
GOTO *A
ENDIF
*B
SETMD O171,1,0,3
*126
MOVEX A=1, AC=2, SM=1, M1X, L, P126, R=V30%, H=1, MS	'126
INH
LETVI V18%,126
*125
MOVEX A=1, AC=1, SM=1, M1X, L, P125, R=V30%, H=1, MS	'125
INH
LETVI V18%,125
*124
MOVEX A=1, AC=1, SM=1, M1X, L, P124, R=V30%, H=1, MS	'124
INH
LETVI V18%,124
*121
MOVEX A=1, AC=1, SM=1, M1X, L, P121, R=V30%, H=1, MS	'121
INH
LETVI V18%,121
*17
MOVEX A=1, AC=1, SM=1, M1X, L, P17, R=V30%, H=1, MS	'17
INH
LETVI V18%,17
*18
MOVEX A=1, AC=1, SM=1, M1X, L, P18, R=V30%, H=1, MS	'18
INH
LETVI V18%,18
SETMD O207,1,0,2
LETVI V20%,13	'到開蓋位
IF I171=1	'回原點訊號ON時
SETM O213,1	'LD門鎖開蓋開
DELAY 1
WAITI I213
SETM O213,0
GOTO *D
ELSE
GOTO *C
ENDIF
*C
IF V2%=14
LETVI V35%,14	'紀錄PLC交握數值
GOTO *D
' ELSEIF V2%=16 'BARCODE條碼錯誤走退回程序 
' LETVI V35%,16 '紀錄PLC交握數值 
' DELAY 3 '延遲2秒再啟動 
' GOTO *F 
ELSE
GOTO *C
ENDIF
*D
SETMD O171,1,0,3
*19
MOVEX A=1, AC=1, SM=1, M1X, L, P19, S=200, H=1, MS	'19
INH
LETVI V18%,19
SETMD O207,1,0,5
LETVI V20%,14	'到微開蓋位
IF I171=1	'回原點訊號ON時
GOTO *F
ELSE
GOTO *E
ENDIF
*E
IF V2%=52
GOTO *F	'檢查無物
ELSE
GOTO *E
ENDIF
*F
SETMD O171,1,0,3
*177
MOVEX A=1, AC=1, SM=1, M1X, L, P17, R=V30%, H=1, MS	'17
INH
LETVI V18%,177
*11
MOVEX A=1, AC=1, SM=1, M1X, L, P11, R=V30%, H=1, MS	'11
INH
LETVI V18%,11
*51
MOVEX A=1, AC=1, SM=1, M1X, P, P51, S=4500, H=1, MS	'51
INH
LETVI V18%,51
SETM O188,0	'關閉路徑訊號
SETM O189,0	'關閉路徑訊號
*52
MOVEX A=1, AC=1, SM=1, M1X, L, P52, R=V30%, H=1, MS	'52
INH
LETVI V18%,52
*53
MOVEX A=1, AC=1, SM=1, M1X, L, P53, R=V30%, H=1, MS	'53
INH
LETVI V18%,53
*54
MOVEX A=1, AC=2, SM=1, M1X, L, P54, R=V30%, H=1, MS	'54
INH
LETVI V18%,54
*55
MOVEX A=1, AC=1, SM=1, M1X, L, P55, S=100, H=1, MS	'55
INH
LETVI V18%,55
SETMD O207,1,0,5
LETVI V20%,52	'到AOI位
IF I171=1	'回原點訊號ON時
SETM O211,1	'夾爪開
DELAY 1
WAITI I211
SETM O211,0
GOTO *M
ELSE
GOTO *L
ENDIF
*L
IF V2%=51
LETVI V35%,51	'紀錄PLC交握數值
GOTO *M
ELSE
GOTO *L
ENDIF
*M
SETMD O171,1,0,3
MOVEX A=1, AC=1, SM=1, M1X, L, P54, R=V30%, H=1, MS	'54
INH
LETVI V18%,54
MOVEX A=5, AC=1, SM=1, M1X, L, P53, R=V30%, H=1, MS	'53
INH
LETVI V18%,53
MOVEX A=5, AC=1, SM=1, M1X, L, P52, R=V30%, H=1, MS	'52
INH
LETVI V18%,52
MOVEX A=5, AC=1, SM=1, M1X, L, P51, R=V30%, H=1, MS	'51
INH
LETVI V18%,51
*END
SETMD O207,1,0,5
LETVI V20%,11	'回原點位
SETM O170,1
SETMD O172,1,0,5
JMPP 1
END
